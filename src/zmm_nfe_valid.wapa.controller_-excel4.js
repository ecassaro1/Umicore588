sap.ui.define(["sap/ui/core/util/Export","sap/ui/core/util/ExportTypeCSV","sap/ui/export/Spreadsheet","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel"],function(t,e,o,a,n,r){"use strict";let s={OC:null,oView:null,localFul+
l:{},Export:function(t,e){this.OC=t;this.oView=e;e.setBusy(true);this._fetchFull().then(this._enrichIt.bind(this),t=>{debugger}).then(this._exportIt.bind(this))},_fetchFull:async function(){var t=this.OC.getModel("localShort");var e=this.OC.getModel();va+
r o=r(t);return new Promise((t,a)=>{e.read("/XML_It",{urlParameters:{$expand:"to_eDoc,to_eDocIt",$top:"100000"},filters:o,success:e=>{t(e)},error:t=>{a(t)}})});function r(t){var e=[];t.forEach(t=>{var o=new a("Chave",n.EQ,t.Accesskey);e.push(o)});return +
e}},_enrichIt:function(t){var e=t.results.map(t=>{var e=t;if(t.to_eDocIt){if(t.to_eDocIt.VIcmsDeson>0){t.to_eDocIt.POVlIcms=0}}if(t.to_xml){e.Divergencias=t.to_xml.Divergencias?"Sim":"Não"}return e});return e},_exportIt(o){var a=new r(o);var n=new t({exp+
ortType:new e({separatorChar:";"}),models:a,rows:{path:"/"},columns:[{name:"Status Validação",template:{content:{parts:["to_eDoc/StatusValid"],formatter:function(t){if(!t)return;switch(t){case"S":return"Sucesso";case"E":return"Erro";case"W":return"Aviso"+
;default:return"Indefinido"}}}}},{name:"Número da Nfe",template:{content:{parts:["to_eDoc/Nfenum"]}}},{name:"Item NF",template:{content:{parts:["Id"]}}},{name:"Nº Pedido",template:{content:{parts:["XPed"]}}},{name:"Nº do Item do pedido",template:{content+
:{parts:["NItemPed"]}}},{name:"Descrição XML",template:{content:{parts:["to_eDocIt/XProd"]}}},{name:"Descrição Pedido",template:{content:{parts:["to_eDocIt/POTxz01"]}}},{name:"Recebedor",template:{content:{parts:["to_eDocIt/POWempf"]}}},{name:"Pto.descar+
ga",template:{content:{parts:["to_eDocIt/POAblad"]}}},{name:"Quantidade XML",template:{content:{parts:["to_eDocIt/QCom"],type:"sap.ui.model.type.Currency",formatOptions:{showMeasure:true}}}},{name:"Quantidade Pedido",template:{content:{parts:["to_eDocIt/+
POMenge"],type:"sap.ui.model.type.Quantidade",formatOptions:{showMeasure:true}}}},{name:"Unid.Med.XML",template:{content:{parts:["to_eDocIt/UTrib"]}}},{name:"Unid.Med.Pedido",template:{content:{parts:["to_eDocIt/POMeins"]}}},{name:"NCM XML",template:{con+
tent:{parts:["to_eDocIt/Ncm"]}}},{name:"NCM Pedido",template:{content:{parts:["to_eDocIt/POJ1bnbm"]}}},{name:"Origem XML",template:{content:{parts:["to_eDocIt/IcmsOrig"]}}},{name:"Origem Pedido",template:{content:{parts:["to_eDocIt/POJ1bmatorg"]}}},{name+
:"CFOP XML",template:{content:{parts:["to_eDocIt/Cfop"]}}},{name:"Classificação",template:{content:{parts:["to_eDocIt/POKnttp"]}}},{name:"Utilização Pedido",template:{content:{parts:["to_eDocIt/POJ1bmatuse"]}}},{name:"CTG. Material",template:{content:{pa+
rts:["to_eDocIt/POJ1bindust"]}}},{name:"Conta do Razão",template:{content:{parts:["to_eDocIt/POSakto"]}}},{name:"Centro custo",template:{content:{parts:["to_eDocIt/POKostl"]}}},{name:"Grupo Mercadorias",template:{content:{parts:["to_eDocIt/POMatkl"]}}},{+
name:"Descrição do Grupo de Mercadorias",template:{content:{parts:["to_eDocIt/POWgbez"]}}},{name:"IVA Pedido",template:{content:{parts:["to_eDocIt/POMwskz"]}}},{name:"CST ICMS XML",template:{content:{parts:["to_eDocIt/IcmsCst"],formatter:function(t){if(!+
t)return;return"'"+t+"'"}}}},{name:"CST ICMS Sit.Fiscal SAP",template:{content:{parts:["to_eDocIt/POIcmsCst"]}}},{name:"CST PIS XML",template:{content:{parts:["to_eDocIt/PisCst"],formatter:function(t){if(!t)return;return"'"+t+"'"}}}},{name:"CST PIS Sit.F+
iscal SAP",template:{content:{parts:["to_eDocIt/POPisCst"]}}},{name:"CST COFINS XML",template:{content:{parts:["to_eDocIt/CofinsCst"],formatter:function(t){if(!t)return;return"'"+t+"'"}}}},{name:"CST COFINS Sit.Fiscal SAP",template:{content:{parts:["to_e+
DocIt/POCofinsCst"]}}},{name:"Pr.Unit.XML",template:{content:{parts:["to_eDocIt/PrUnit"]}}},{name:"Pr.Unit.Pedido",template:{content:{parts:["to_eDocIt/PONetpr"]}}},{name:"BC ICMS XML",template:{content:{parts:["to_eDocIt/IcmsVbc"],type:"sap.ui.model.typ+
e.Currency",formatOptions:{showMeasure:true}}}},{name:"BC ICMS Pedido",template:{content:{parts:["to_eDocIt/POBcIcms"],type:"sap.ui.model.type.Currency",formatOptions:{showMeasure:true}}}},{name:"Alíq.ICMS XML",template:{content:{parts:["to_eDocIt/PIcms"+
],type:"sap.ui.model.type.Quantidade",formatOptions:{showMeasure:true}}}},{name:"Alíq.ICMS Pedido",template:{content:{parts:["to_eDocIt/POAliqIcms"],type:"sap.ui.model.type.Quantidade",formatOptions:{showMeasure:true}}}},{name:"Vl.ICMS XML",template:{con+
tent:{parts:["to_eDocIt/VIcms"],type:"sap.ui.model.type.Currency",formatOptions:{showMeasure:true}}}},{name:"Vl.ICMS Pedido",template:{content:{parts:["to_eDocIt/POVlIcms"],type:"sap.ui.model.type.Currency",formatOptions:{showMeasure:true}}}},{name:"Vl.I+
CMS Deson.XML",template:{content:{parts:["to_eDocIt/VIcmsDeson"],type:"sap.ui.model.type.Currency",formatOptions:{showMeasure:true}}}},{name:"Vl.ICMS Deson.Pedido",template:{content:{parts:["to_eDocIt/VIcmsDeson"],type:"sap.ui.model.type.Currency",format+
Options:{showMeasure:true}}}},{name:"Alí.IPI XML",template:{content:{parts:["to_eDocIt/PIpi"],type:"sap.ui.model.type.Quantidade",formatOptions:{showMeasure:true}}}},{name:"Alí.IPI Pedido",template:{content:{parts:["to_eDocIt/POAliqIpi"],type:"sap.ui.mod+
el.type.Quantidade",formatOptions:{showMeasure:true}}}},{name:"Vl.IPI XML",template:{content:{parts:["to_eDocIt/Vipi"],type:"sap.ui.model.type.Currency",formatOptions:{showMeasure:true}}}},{name:"Vl.IPI Pedido",template:{content:{parts:["to_eDocIt/POVlIp+
i"],type:"sap.ui.model.type.Currency",formatOptions:{showMeasure:true}}}},{name:"Vl.Desc.XML",template:{content:{parts:["to_eDocIt/VDesc"],type:"sap.ui.model.type.Currency",formatOptions:{showMeasure:true}}}},{name:"Vl.Desc.SAP",template:{content:{parts:+
["to_eDocIt/POVlDesc"],type:"sap.ui.model.type.Currency",formatOptions:{showMeasure:true}}}},{name:"Vl.Br.Item XML",template:{content:{parts:["to_eDocIt/VProd"],type:"sap.ui.model.type.Currency",formatOptions:{showMeasure:true}}}},{name:"Vl.Total Item Pe+
dido",template:{content:{parts:["to_eDocIt/PONetwr"],type:"sap.ui.model.type.Currency",formatOptions:{showMeasure:true}}}},{name:"Incoterm Pedido",template:{content:{parts:["to_eDocIt/POInco1"]}}},{name:"Estado",template:{content:{parts:["to_eDocIt/POPro+
cstat"],formatter:function(t){if(!t)return;switch(t){case"01":return"01-Versão em processo";case"02":return"02-Ativo";case"03":return"03-Em liberação";case"04":return"04-Liberação parcial";case"05":return"05-Liberação concluída";case"08":return"08-Recusa+
do";case"11":return"11-Na distribuição";case"12":return"12-Erro na distribuição";case"13":return"13-Distribuído";case"14":return"14-Em preparação";case"26":return"26-Em aprovação externa";default:return t}}}}},{name:"Entr.mercads.",template:{content:{par+
ts:["to_eDocIt/POWepos"]}}},{name:"Ctrl.confirm.",template:{content:{parts:["to_eDocIt/POBstae"]}}},{name:"Data de remessa",template:{content:{parts:["to_eDocIt/POEindt"]}}}]});n.saveFile().catch(function(t){MessageBox.error("Error when downloading data.+
 Browser might not be supported!"+"\n\n"+t)}).then(function(){n.destroy()});this.oView.setBusy(false)},getI18nText:function(t){return this.OC.getModel("i18n").getResourceBundle().getText(t)}};return s.Export.bind(s)});                                     