sap.ui.define(["sap/ui/core/util/Export","sap/ui/core/util/ExportTypeCSV","sap/ui/export/Spreadsheet","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel"],function(e,t,r,n,o,a){"use strict";let s={OC:null,oView:null,localFul+
l:{},Export:function(e,t){this.OC=e;this.oView=t;t.setBusy(true);this._fetchFull().then(this._enrichIt.bind(this),e=>{debugger}).then(this._exportIt.bind(this))},_fetchFull:async function(){var e=this.OC.getModel("localShort");var t=this.OC.getModel();va+
r r=a(e);return new Promise((e,n)=>{t.read("/Errors",{urlParameters:{$expand:"to_Header/to_eDoc",$top:"100000"},filters:r,success:t=>{e(t)},error:e=>{n(e)}})});function a(e){var t=[];e.forEach(e=>{var r=new n("Chave",o.EQ,e.Accesskey);t.push(r)});var r=n+
ew n("Inactive",o.EQ,"");t.push(r);return t}},_enrichIt:function(e){var t=e.results.map(e=>{var t=e;return t});return t},_exportIt(r){var n=new a(r);var o=new e({exportType:new t({separatorChar:";"}),models:n,rows:{path:"/"},columns:[{name:"Status Valida+
ção",template:{content:{parts:["StatusValid"],formatter:function(e){if(!e)return;switch(e){case"E":return"Erro";case"W":return"Aviso";default:return"Indefinido"}}}}},{name:"Num.NF.",template:{content:{parts:["NNf"]}}},{name:"Item XML",template:{content:{+
parts:["ItemXml"]}}},{name:"Nº Pedido",template:{content:{parts:["Pedido"]}}},{name:"Item do Pedido",template:{content:{parts:["ItemPedido"]}}},{name:"Descrição do Erro",template:{content:{parts:["Texto"]}}},{name:"Valor XML",template:{content:{parts:["V+
alorXml"],formatter:function(e){if(!e)return;e="'"+e.trim()+"'";return e}}}},{name:"Valor SAP",template:{content:{parts:["ValorSap"],formatter:function(e){if(!e)return;e="'"+e.trim()+"'";return e}}}}]});o.saveFile().catch(function(e){MessageBox.error("Er+
ror when downloading data. Browser might not be supported!"+"\n\n"+e)}).then(function(){o.destroy()});this.oView.setBusy(false)},getI18nText:function(e){return this.OC.getModel("i18n").getResourceBundle().getText(e)}};return s.Export.bind(s)});           