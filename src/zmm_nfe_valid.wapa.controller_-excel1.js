sap.ui.define(["sap/ui/core/util/Export","sap/ui/core/util/ExportTypeCSV","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel"],function(e,t,n,r,a){"use strict";let o={OC:null,oView:null,localFull:{},Export:function(e,t){this+
.OC=e;this.oView=t;t.setBusy(true);this._fetchFull().then(this._enrichIt.bind(this),e=>{debugger}).then(this._exportIt.bind(this))},_fetchFull:async function(){var e=this.OC.getModel("localShort");var t=this.OC.getModel();var a=o(e);return new Promise((e+
,n)=>{t.read("/eDocXls1",{urlParameters:{$expand:"to_xml,to_Items,to_xml/to_Items",$top:"20000"},filters:a,success:t=>{e(t)},error:e=>{n(e)}})});function o(e){var t=[];e.forEach(e=>{var a=new n("Accesskey",r.EQ,e.Accesskey);t.push(a)});t.push(new n("Stat+
us",r.NE,"8"));return t}},_enrichIt:function(e){var t=e.results.map(e=>{var t=e;if(e.to_xml&&e.to_xml.to_Items){var n=[];e.to_xml.to_Items.results.forEach(e=>{if(n.includes(e.XPed)){}else{n.push(e.XPed);t.Pedidos=(t.Pedidos?t.Pedidos+"/":"")+e.XPed}})}if+
(e.to_Items){var r=[];e.to_Items.results.forEach(e=>{if(r.includes(e.Cfop)){}else{r.push(e.Cfop);t.Cfop=(t.Cfop?t.Cfop+"/":"")+e.Cfop}})}if(e.to_xml){t.Divergencias=e.to_xml.Divergencias?"Sim":"Não"}else{t.Divergencias="Não"}return t});return t},_exportI+
t(n){var r=new a(n);var o=new e({exportType:new t({separatorChar:";"}),models:r,rows:{path:"/"},columns:[{name:"Status Controle",template:{content:{parts:["Status"],formatter:function(e){if(!e)return;switch(e){case"0":return"Indefinido";case"1":return"Li+
berado";case"2":return"Arquivado";case"3":return"Desfeito";case"9":return"Rejeitado";default:return"Indefinido"}}}}},{name:"Mês de Emissão",template:{content:{parts:["InfnfeIdeDhemi"],formatter:function(e){if(!e)return;var t=e.substr(3,2);switch(t){case"+
01":return"Janeiro";case"02":return"Fevereiro";case"03":return"Março";case"04":return"Abril";case"05":return"Maio";case"06":return"Junho";case"07":return"Julho";case"08":return"Agosto";case"09":return"Setembro";case"10":return"Outubro";case"11":return"No+
vembro";case"12":return"Dezembro"}}}}},{name:"Data de Emissão",template:{content:"{InfnfeIdeDhemi}"}},{name:"Número da Nfe",template:{content:"{Nfenum}"}},{name:"Chave de Acesso",template:{content:{parts:["Accesskey"],formatter:function(e){if(!e)return;r+
eturn"'"+e+"'"}}}},{name:"Divergência",template:{content:"{Divergencias}"}},{name:"Valor Nfe",template:{content:{parts:[{path:"InfNFeTotalIcmstotVnf"}],type:"sap.ui.model.type.Currency",formatOptions:{showMeasure:true}}}},{name:"Data de Vencimento",templ+
ate:{content:"{InfnfeCobrDupDvenc}"}},{name:"Tipo NFe",template:{content:{parts:["InfnfeIdeTpnf"],formatter:function(e){if(!e)return;switch(e){case"0":return"0 - Entrada";case"1":return"1 - Saída"}}}}},{name:"Finalidade",template:{content:{parts:["Infnfe+
IdeFinnfe"],formatter:function(e){if(!e)return;switch(e){case"1":return"1 - Normal";case"2":return"2 - Complementar";case"3":return"3 - NF-e de ajuste";case"4":return"4 - Devolução de Mercadoria"}}}}},{name:"Natureza da Operação",template:{content:"{Infn+
feIdeNatOp}"}},{name:"CFOP",template:{content:"{Cfop}"}},{name:"Pin",template:{content:{parts:["to_xml/Pin"],formatter:function(e){if(!e)return"Indefinido";switch(e){case"0":return"Indefinido";case"1":return"Não Necessita Pin";case"2":return"Analisar";ca+
se"3":return"Necessita Pin";case"4":return"Pin Aceito";default:return"Indefinido"}}}}},{name:"Número da Nfe de Referência",template:{content:"{InfnfeIdeNfrefNnf}"}},{name:"Chave de Acesso Nfe de Referência",template:{content:{parts:["InfnfeIdeNfrefRefnfe+
"],formatter:function(e){if(!e)return;return"'"+e+"'"}}}},{name:"Comprador(a)",template:{content:"{EkkoUserName}"}},{name:"Pedido/Programa",template:{content:"{Pedidos}"}},{name:"UF Emitente",template:{content:"{InfnfeEmitEnderemitUf}"}},{name:"CNPJ do E+
mitente",template:{content:{parts:["InfnfeEmitCnpj"],formatter:function(e){if(!e)return;return e.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/g,"$1.$2.$3/$4-$5")}}}},{name:"Emitente",template:{content:"{InfnfeEmitXnome}"}},{name:"CNPJ do Destinatário",te+
mplate:{content:{parts:["InfnfeDestCnpj"],formatter:function(e){if(!e)return;return e.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/g,"$1.$2.$3/$4-$5")}}}},{name:"Destinatário",template:{content:"{InfnfeDestXnome}"}},{name:"Inscrição Estadual do Destinatá+
rio",template:{content:{parts:["InfnfeDestIe"],formatter:function(e){if(!e)return;return"'"+e+"'"}}}},{name:"Inscrição Suframa do Destinatário",template:{content:"{InfnfeDestEnderDestIsuf}"}},{name:"Modalidade do Frete + Descrição",template:{content:{par+
ts:["InfnfeTranspModFrete"],formatter:function(e){if(!e)return;switch(e){case"0":return"0 - Contratação do Frete por conta do Remetente (CIF)";case"1":return"1 - Contratação do Frete por conta do Destinatário (FOB)";case"2":return"2 - Contratação do Fret+
e por conta de Terceiros";case"3":return"3 - Transporte Próprio por conta do Remetente";case"4":return"4 - Transporte Próprio por conta do Destinatário";case"9":return"9 - Sem Ocorrência de Transporte";default:return""}}}}},{name:"CNPJ da Transportadora"+
,template:{content:{parts:["InfnfeTranspTransportaCnpj"],formatter:function(e){if(!e)return;return e.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/g,"$1.$2.$3/$4-$5")}}}},{name:"Nome Transportadora",template:{content:"{InfnfeTranspTransportaXnome}"}}]});o+
.saveFile().catch(function(e){MessageBox.error("Error when downloading data. Browser might not be supported!"+"\n\n"+e)}).then(function(){o.destroy()});this.oView.setBusy(false)},getI18nText:function(e){return this.OC.getModel("i18n").getResourceBundle()+
.getText(e)}};return o.Export.bind(o)});                                                                                                                                                                                                                       