sap.ui.define(["sap/ui/core/util/Export","sap/ui/core/util/ExportTypeCSV","sap/ui/export/Spreadsheet","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel"],function(e,t,r,n,o,a){"use strict";let s={OC:null,oView:null,localFul+
l:{},Export:function(e,t){this.OC=e;this.oView=t;t.setBusy(true);this._fetchFull().then(this._enrichIt.bind(this),e=>{debugger}).then(this._exportIt.bind(this))},_fetchFull:async function(){var e=this.OC.getModel("localShort");var t=this.OC.getModel();va+
r r=a(e);return new Promise((e,n)=>{t.read("/XML_Cod",{urlParameters:{$expand:"to_Header/to_eDoc,to_Header/to_Items",$top:"100000"},filters:r,success:t=>{e(t)},error:e=>{n(e)}})});function a(e){var t=[];e.forEach(e=>{var r=new n("Chave",o.EQ,e.Accesskey)+
;t.push(r)});return t}},_enrichIt:function(e){var t=e.results.map(e=>{var t=e;if(e.to_Header&&e.to_Header.to_Items){var r=[];e.to_Header.to_Items.results.forEach(e=>{if(r.includes(e.XPed)){return}r.push(e.XPed);t.Pedidos=(t.Pedidos?t.Pedidos+"/":"")+e.XP+
ed})}if(e.to_xml){t.Divergencias=e.to_xml.Divergencias?"Sim":"Não"}return t});return t},_exportIt(r){var n=new a(r);var o=new e({exportType:new t({separatorChar:";"}),models:n,rows:{path:"/"},columns:[{name:"Status De Controle",template:{content:{parts:[+
"to_Header/to_eDoc/Status"],formatter:function(e){if(!e)return;switch(e){case"0":return"Indefinido";case"1":return"Liberado";case"2":return"Arquivado";case"3":return"Desfeito";case"9":return"Rejeitado";default:return"Indefinido"}}}}},{name:"Mês de Emissã+
o",template:{content:{parts:["to_Header/to_eDoc/InfnfeIdeDhemi"],formatter:function(e){if(!e)return;var t=e.substr(3,2);switch(t){case"01":return"Janeiro";case"02":return"Fevereiro";case"03":return"Março";case"04":return"Abril";case"05":return"Maio";case+
"06":return"Junho";case"07":return"Julho";case"08":return"Agosto";case"09":return"Setembro";case"10":return"Outubro";case"11":return"Novembro";case"12":return"Dezembro"}}}}},{name:"Data de Emissão",template:{content:{parts:["to_Header/to_eDoc/InfnfeIdeDh+
emi"]}}},{name:"Número da Nfe",template:{content:{parts:["to_Header/to_eDoc/Nfenum"]}}},{name:"Número da Nfe de Referência",template:{content:{parts:["to_Header/to_eDoc/InfnfeIdeNfrefNnf"]}}},{name:"Tipo NFe",template:{content:{parts:["to_Header/to_eDoc/+
InfnfeIdeTpnf"],formatter:function(e){if(!e)return;switch(e){case"0":return"0 - Entrada";case"1":return"1 - Saída"}}}}},{name:"Finalidade",template:{content:{parts:["to_Header/to_eDoc/InfnfeIdeFinnfe"],formatter:function(e){if(!e)return;switch(e){case"1"+
:return"1 - Normal";case"2":return"2 - Complementar";case"3":return"3 - NF-e de ajuste";case"4":return"4 - Devolução de Mercadoria"}}}}},{name:"Natureza da Operação",template:{content:{parts:["to_Header/to_eDoc/InfnfeIdeNatOp"]}}},{name:"Código Divergênc+
ia",template:{content:{parts:["CodDiv"],formatter:function(e){if(!e)return;return"'"+e+"'"}}}},{name:"Descrição Divergência",template:{content:{parts:["NomeDiv"]}}},{name:"Comprador(a)",template:{content:{parts:["to_Header/to_eDoc/EkkoUserName"]}}},{name+
:"Pedido(s)",template:{content:{parts:["Pedidos"]}}},{name:"UF Emitente",template:{content:{parts:["to_Header/to_eDoc/InfnfeEmitEnderemitUf"]}}},{name:"CNPJ do Emitente",template:{content:{parts:["to_Header/to_eDoc/InfnfeEmitCnpj"],formatter:function(e){+
if(!e)return;return e.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/g,"$1.$2.$3/$4-$5")}}}},{name:"Emitente",template:{content:{parts:["to_Header/to_eDoc/InfnfeEmitXnome"]}}}]});o.saveFile().catch(function(e){MessageBox.error("Error when downloading data.+
 Browser might not be supported!"+"\n\n"+e)}).then(function(){o.destroy()});this.oView.setBusy(false)},getI18nText:function(e){return this.OC.getModel("i18n").getResourceBundle().getText(e)}};return s.Export.bind(s)});                                     